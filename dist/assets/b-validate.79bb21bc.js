import{i as E}from"./lodash.isequal.2aa59b76.js";var g=Object.prototype.toString;function O(i){return g.call(i)==="[object Array]"}function l(i){return g.call(i)==="[object Object]"}function x(i){return g.call(i)==="[object String]"}function q(i){return g.call(i)==="[object Number]"&&i===i}function V(i){return g.call(i)==="[object Boolean]"}function f(i){return i==null||i===""}function _(i){return O(i)&&!i.length}function A(i){return l(i)&&!Object.keys(i).length}var c=function(t,r){l(r)&&x(t)&&r.trim?this.obj=t.trim():l(r)&&r.ignoreEmptyString&&t===""?this.obj=void 0:this.obj=t,this.message=r.message,this.type=r.type,this.error=null},j={not:{configurable:!0},isRequired:{configurable:!0},end:{configurable:!0}};j.not.get=function(){return this._not=!this._not,this};j.isRequired.get=function(){return(f(this.obj)||_(this.obj))&&(this.error={value:this.obj,type:this.type,requiredError:!0,message:this.message||(this._not?"[NOT MODE]:":"")+this.type+" is required"}),this};j.end.get=function(){return this.error};c.prototype.addError=function(t){!this.error&&t&&(this.error={value:this.obj,type:this.type,message:this.message||(l(t)?t:(this._not?"[NOT MODE]:":"")+t)})};c.prototype.validate=function(t,r){var o=this._not?t:!t;return o&&this.addError(r),this};c.prototype.collect=function(t){t&&t(this.error)};Object.defineProperties(c.prototype,j);var N=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"string"})),this.validate(e&&e.strict?x(this.obj):!0,"Expect string type but got "+typeof this.obj)}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={uppercase:{configurable:!0},lowercase:{configurable:!0}};return t.prototype.maxLength=function(e){return this.obj?this.validate(this.obj.length<=e,"Expect max length "+e+" but got "+this.obj.length):this},t.prototype.minLength=function(e){return this.obj?this.validate(this.obj.length>=e,"Expect min length "+e+" but got "+this.obj.length):this},t.prototype.length=function(e){return this.obj?this.validate(this.obj.length===e,"Expect length "+e+" but got "+this.obj.length):this},t.prototype.match=function(e){var n=e instanceof RegExp;return n&&(e.lastIndex=0),this.validate(this.obj===void 0||n&&e.test(this.obj),"`"+this.obj+"` is not match pattern "+e)},r.uppercase.get=function(){return this.obj?this.validate(this.obj.toUpperCase()===this.obj,"Expect `"+this.obj+"` to be uppercased"):this},r.lowercase.get=function(){return this.obj?this.validate(this.obj.toLowerCase()===this.obj,"Expect `"+this.obj+"` to be lowercased"):this},Object.defineProperties(t.prototype,r),t}(c),J=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"number"})),this.validate(e&&e.strict?q(this.obj):!0,"Expect number type but got "+typeof this.obj)}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={positive:{configurable:!0},negative:{configurable:!0}};return t.prototype.min=function(e){return f(this.obj)?this:this.validate(this.obj>=e,"`"+this.obj+"` is not greater than `"+e+"`")},t.prototype.max=function(e){return f(this.obj)?this:this.validate(this.obj<=e,"`"+this.obj+"` is not less than `"+e+"`")},t.prototype.equal=function(e){return f(this.obj)?this:this.validate(this.obj===e,"`"+this.obj+"` is not equal to `"+e+"`")},t.prototype.range=function(e,n){return f(this.obj)?this:this.validate(this.obj>=e&&this.obj<=n,"`"+this.obj+"` is not in range `"+e+" ~ "+n+"`")},r.positive.get=function(){return f(this.obj)?this:this.validate(this.obj>0,"Expect number to be positive, but got `"+this.obj+"`")},r.negative.get=function(){return f(this.obj)?this:this.validate(this.obj<0,"Expect number to be negative, but got `"+this.obj+"`")},Object.defineProperties(t.prototype,r),t}(c),L=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"array"})),this.validate(e&&e.strict?O(this.obj):!0,"Expect array type but got `"+this.obj+"`")}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={empty:{configurable:!0}};return t.prototype.length=function(e){return this.obj?this.validate(this.obj.length===e,"Expect array length "+e+" but got "+this.obj.length):this},t.prototype.minLength=function(e){return this.obj?this.validate(this.obj.length>=e,"Expect min array length "+e+" but got "+this.obj.length):this},t.prototype.maxLength=function(e){return this.obj?this.validate(this.obj.length<=e,"Expect max array length "+e+" but got "+this.obj.length):this},t.prototype.includes=function(e){var n=this;return this.obj?this.validate(e.every(function(u){return n.obj.indexOf(u)!==-1}),JSON.stringify(this.obj)+" is not includes "+JSON.stringify(e)):this},t.prototype.deepEqual=function(e){return this.obj?this.validate(E(this.obj,e),JSON.stringify(this.obj)+" is not deep equal with "+JSON.stringify(e)):this},r.empty.get=function(){return this.validate(_(this.obj),"Expect empty array but got "+JSON.stringify(this.obj))},Object.defineProperties(t.prototype,r),t}(c),P=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"object"})),this.validate(e&&e.strict?l(this.obj):!0,"Expect object type but got `"+this.obj+"`")}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={empty:{configurable:!0}};return t.prototype.deepEqual=function(e){return this.obj?this.validate(E(this.obj,e),JSON.stringify(this.obj)+" is not deep equal with "+JSON.stringify(e)):this},t.prototype.hasKeys=function(e){var n=this;return this.obj?this.validate(e.every(function(u){return n.obj[u]}),JSON.stringify(this.obj)+" is not has keys "+e):this},r.empty.get=function(){return this.validate(A(this.obj),"Expect empty object but got "+JSON.stringify(this.obj))},Object.defineProperties(t.prototype,r),t}(c),$=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"boolean"})),this.validate(e&&e.strict?V(this.obj):!0,"Expect boolean type but got "+typeof this.obj)}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={true:{configurable:!0},false:{configurable:!0}};return r.true.get=function(){return this.validate(this.obj===!0,"Expect true but got false")},r.false.get=function(){return this.validate(this.obj===!1,"Expect false but got true")},Object.defineProperties(t.prototype,r),t}(c),z=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,R=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),C=/^(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})(\.(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})){3}$/,T=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"type"}))}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={email:{configurable:!0},url:{configurable:!0},ip:{configurable:!0}};return r.email.get=function(){return this.validate(this.obj===void 0||z.test(this.obj),"Expect type email but got `"+this.obj+"`")},r.url.get=function(){return this.validate(this.obj===void 0||R.test(this.obj),"Expect type url but got `"+this.obj+"`")},r.ip.get=function(){return this.validate(this.obj===void 0||C.test(this.obj),"Expect type ip but got `"+this.obj+"`")},Object.defineProperties(t.prototype,r),t}(c),D=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"custom"}))}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={validate:{configurable:!0}};return r.validate.get=function(){var o=this;return function(e,n){var u;if(e)return u=e(o.obj,o.addError.bind(o)),u&&u.then?(n&&u.then(function(){n&&n(o.error)},function(s){console.error(s)}),[u,o]):(n&&n(o.error),this.error)}},Object.defineProperties(t.prototype,r),t}(c),m=function(t,r){this.string=new N(t,r),this.number=new J(t,r),this.array=new L(t,r),this.object=new P(t,r),this.boolean=new $(t,r),this.type=new T(t,r),this.custom=new D(t,r)},I=function(t,r){r===void 0&&(r={}),this.schema=t,this.options=r};I.prototype.validate=function(t,r){var o=this;if(!l(t))return;var e=[],n=null;function u(s,d){n||(n={}),(!n[s]||d.requiredError)&&(n[s]=d)}this.schema&&Object.keys(this.schema).forEach(function(s){if(O(o.schema[s]))for(var d=function(w){var p=o.schema[s][w],b=p.type,v=p.message,a=void 0;if(!b&&!p.validator)throw"You must specify a type to field "+s+"!";if(b==="email"||b==="url"||b==="ip")a=new m(t[s],Object.assign({},o.options,{message:v})).type[b];else if(p.validator){a=new m(t[s],Object.assign({},o.options,{message:v})).custom.validate(p.validator),Object.prototype.toString.call(a)==="[object Array]"&&a[0].then?e.push({function:a[0],_this:a[1],key:s}):a&&u(s,a);return}else a=new m(t[s],Object.assign({},o.options,{message:v}))[b];if(Object.keys(p).forEach(function(h){p.required&&(a=a.isRequired),h!=="message"&&a[h]&&p[h]&&typeof a[h]=="object"&&(a=a[h]),a[h]&&p[h]!==void 0&&typeof a[h]=="function"&&(a=a[h](p[h]))}),a.collect(function(h){h&&u(s,h)}),n)return"break"},y=0;y<o.schema[s].length;y++){var S=d(y);if(S==="break")break}}),e.length>0?Promise.all(e.map(function(s){return s.function})).then(function(){e.forEach(function(s){s._this.error&&u(s.key,s._this.error)}),r&&r(n)}):r&&r(n)};export{I as S};
